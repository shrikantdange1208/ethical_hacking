<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Finding the Right Module</title>
</head><body>FInd a dll or something similar inside of a program that has no memory protection i.e, no DEP, no ALSR, no Safe SEH <br/>
In Vulnerver it is essfunc.dll<br/>
<br/>
We can use mono_modules tool with Immunity Debugger to achieve this.<br/>
<a href="https://github.com/corelan/mona">https://github.com/corelan/mona</a>&nbsp; <br/>
Copy mona.py from above git repo to ImmunityDebugger/PyCommands/<br/>
<br/>
In Immunity Debugger type below command<br/>
<b>!mona modules<br/>
</b>Look for all Falses<br/>
<b>In Vulnerver it is essfunc.dll<br/>
<br/>
</b><br/>
<b>Find the OpCode equivalent of a JMP (Convert assembly language into HEX code). In Kali Linux do below steps<br/>
</b>1. locate nasm_shell<br/>
&nbsp; &nbsp;Output: /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb<br/>
2. Execute: /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb<br/>
3. JMP ESP <br/>
&nbsp; &nbsp;Output: 00000000 FFE4 &nbsp; jmp esp<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Hex code equivalent of jmp esp is FFE4) &nbsp; &nbsp; &nbsp;<br/>
4. In ImmunityDebugger execute<br/>
&nbsp; &nbsp; mona find -s "\xff\xe4" -m essfunc.dll<br/>
&nbsp; &nbsp; Look for return addresses.<br/>
</body></html>